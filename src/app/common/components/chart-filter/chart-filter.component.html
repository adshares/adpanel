<div class="filters" (clickOutside)="hideDatepicker()">
  <button class="ap-select lowercase-to-capitalize" (click)="showDatepicker()">
    <span *ngIf="currentFilterPreset">{{ currentFilterPreset.name }}</span>
    <span *ngIf="!currentFilterPreset">From {{ ' ' + currentFromFilter + ' ' }} to {{ ' ' + currentToFilter }}</span>
  </button>
  <div class="chart-filters ap-box" [class.visible]="datepickerVisible">
    <div class="row filter-row align-center justify-end">
      <span class="ap-copy hidden-md"> Sort by date range </span>
      <button
        type="button"
        *ngFor="let preset of filterPresets"
        class="ap-btn ap-button--small ap-bg-white ap-navy lowercase-to-capitalize"
        [class.selected]="preset.id === currentDaysSpan"
        (click)="filterChart(preset.id, 0, false)"
        data-test="chart-filter-preset">
        {{ preset.name }}
      </button>
    </div>

    <div class="row filter-row align-center justify-end">
      <span class="ap-copy hidden-md"> or select manually </span>
      <label class="ap-copy ap-copy--small"> From </label>
      <mat-form-field
        (click)="dateFromPicker.open()"
        class="ap-form-input ap-form-input--narrow ap-form-input--datepicker ap-form-input--datepicker--narrow row">
        <img src="assets/images/calendar.svg" alt="Select date from" class="ap-icon ap-icon--prepend" />
        <input
          matInput
          [matDatepicker]="dateFromPicker"
          [formControl]="dateFrom"
          required
          [max]="dateTo.value || today"
          data-test="chart-filter-custom-date-from" />
        <mat-datepicker
          #dateFromPicker
          (opened)="setCalendarStatus(true)"
          (closed)="setCalendarStatus(false)"></mat-datepicker>
      </mat-form-field>

      <label class="ap-copy ap-copy--small"> To </label>
      <mat-form-field
        (click)="dateToPicker.open()"
        class="ap-form-input ap-form-input--narrow ap-form-input--datepicker ap-form-input--datepicker--narrow row">
        <img src="assets/images/calendar.svg" alt="Select date to" class="ap-icon ap-icon--prepend" />
        <input
          matInput
          [matDatepicker]="dateToPicker"
          [formControl]="dateTo"
          required
          [min]="dateFrom.value"
          [max]="today"
          data-test="chart-filter-custom-date-to" />
        <mat-datepicker
          #dateToPicker
          (opened)="setCalendarStatus(true)"
          (closed)="setCalendarStatus(false)"></mat-datepicker>
      </mat-form-field>
      <button
        type="button"
        class="ap-btn ap-button--small ap-bg-gray--light ap-navy"
        [class.disabled]="!dateTo.value || !dateFrom.value"
        (click)="filterChartByDatepicker()"
        data-test="chart-filter-apply-datespan-button">
        Apply
        <img class="ap-icon--append" src="assets/images/chevron--right.svg" alt="" />
      </button>
    </div>
  </div>
</div>
